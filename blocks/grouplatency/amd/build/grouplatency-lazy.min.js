define(["jquery","core/ajax","core/templates"],function(a,b,c){return getPluginData=function(d){var e=b.call([{methodname:"block_grouplatency_get_data",args:d}]);e[0].done(function(b){var d=JSON.parse(b.data);0!=d.hasdata||0!=d.preparation?c.render("block_grouplatency/main",d).then(function(a,b){c.replaceNodeContents(".grouplatency-wrapper",a,b),0!=d.hasdata&&require(["block_grouplatency/graph-lazy"],function(a){a.init(d.posts,d.task_period)}),handlePrompt()}).fail(function(a){c.replaceNodeContents(".grouplatency-wrapper","rendering failed")}):a(".block_grouplatency").hide()}).fail(function(a){c.replaceNodeContents(".grouplatency-wrapper","request failed")})},handlePrompt=function(){if(null!=sessionStorage.getItem("prompt")){var b=sessionStorage.getItem("prompt");"expanded"==b?a(".prompt-content").show():(a(".prompt-content").hide(),a(".prompt .arrow").toggleClass("fa-caret-down fa-caret-right"))}a(".prompt-header").click(function(){a(".prompt .arrow").toggleClass("fa-caret-down fa-caret-right"),a(".prompt-content").toggle(),a(".prompt-content").is(":visible")?sessionStorage.setItem("prompt","expanded"):sessionStorage.setItem("prompt","collapsed")})},{init:function(a){getPluginData(a)}}});