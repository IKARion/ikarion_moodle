define(["jquery","block_grouplatency/d3","core/config"],function(a,b,c){return buildChart=function(d){var e,f,g,h,i,j,k,l,m,n,o,p,q;o=document.querySelector(".block_grouplatency #dc-post-chart"),d.forEach(function(a){a.date=new Date(1e3*a.date)});b.timeFormat("%d.%m");n=o.clientWidth,j=b.min(d,function(a){return a.date}),i=b.max(d,function(a){return new Date}),p=b.scaleTime().domain([j,i]).rangeRound([0,n]),m=b.nest().key(function(a){return a.date}).entries(d),l=function(a){return p(a.date)},k=function(a){return p(new Date)-p(a.date)},h=25,f=function(c){var d;d=b.select(this);var e=d.selectAll("rect").data(c.values).enter().append("g").attr("class","rect-row"),f=0,g=0,i=a(".block_grouplatency .bar-graph").offset().left,j=a(".block_grouplatency .bar-graph").width();e.append("rect").attr("x",function(a){return g=l(a)}).attr("y",0).attr("width",function(a){return f=k(a)}).attr("height",h).attr("fill",function(a){return a.color||"#AEAEAE"}).attr("data-id",function(a){return a.id}).attr("class","overdue"),e.append("rect").attr("x",function(a){return g+f-h}).attr("y",0).attr("width",function(a){return h}).attr("height",h).attr("fill",function(a){return"#003560"}).attr("class","answer"),e.append("text").text(function(a){return a.since}).attr("x",function(a){var b=i+j-i-60;return b}).attr("y","18").attr("fill","#003560").attr("text-anchor","middle").attr("class","overdue-text"),e.append("text").attr("font-family","FontAwesome").attr("fontz-size","14px").text(function(a){return"ï„’"}).attr("x",function(a){var b=i+j-i-13;return b}).attr("y","19").attr("fill","#FFF").attr("text-anchor","middle").attr("class","answer-icon").attr("data-postid",function(a){return a.postid}).attr("data-discussid",function(a){return a.discussionid})},e=b.select(o).selectAll("svg").data(m).enter().append("svg").attr("height",h+5).attr("class","border").each(f),q=b.axisBottom(p).ticks(2).tickFormat(b.timeFormat("%d.%m.")),g=b.select(o).append("svg").attr("class","axis").call(q);var r=b.select("body").append("div").attr("class","ttip").style("display","none");e.selectAll(".rect-row").on("mouseover",function(d){r.transition().duration(200).style("display","block"),r.html('<span style="color:#AEAEAE;">'+d.since+'</span><br><a class="user-profile" href="'+c.wwwroot+"/user/view.php?id="+d.userid+"&course="+d.courseid+'"><strong>'+d.user+'</strong></a><br><a class="post-message" href="'+c.wwwroot+"/mod/forum/post.php?reply="+d.postid+'"><span style="text-decoration:underline;">'+d.postmsg+"</span></a>").style("left",function(c){var d=b.event.srcElement,e=a(d).siblings("text.overdue-text").offset().left,f=a(".ttip").outerWidth();return e-f-15+"px"}).style("top",b.event.pageY-28+"px")}),a(".ttip").on("mouseleave",function(b){a(this).hide(500)})},{init:function(a){buildChart(a)}}});